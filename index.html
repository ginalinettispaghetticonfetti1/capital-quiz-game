<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Capital Quiz Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg-main: #121212;
  --bg-surface: #1e1e1e;
  --bg-elevated: #242424;

  --text-primary: #E0E0E0;
  --text-secondary: rgba(224,224,224,0.6);

  --accent: #357ABD;
  --accent-hover: #2C6399;

  --success: #6FBF73;
  --warning: #E6C35C;
  --error: #CF6679;
}

/* ================= BASE ================= */
body {
  font-family: Arial, sans-serif;
  background: var(--bg-main);
  color: var(--text-primary);
  padding: 20px;
  text-align: center;
}

/* ================= FORM ELEMENTS ================= */
select, input {
  width: 100%;
  max-width: 360px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  border-radius: 6px;
  border: none;
  background: var(--bg-surface);
  color: var(--text-primary);
}

/* ================= BUTTONS ================= */
button {
  width: 100%;
  max-width: 360px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  color: var(--text-primary);
}

button:disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

/* ================= PRIMARY ACTION ================= */
.start-btn,
.submit-btn {
  background: var(--accent);
  font-weight: bold;
}
.start-btn:hover,
.submit-btn:hover {
  background: var(--accent-hover);
}

/* ================= SECONDARY ACTIONS ================= */
.next-btn {
  background: #4A4F7C;
}
.next-btn:hover {
  background: #3F4369;
}

.reveal-btn {
  background: var(--warning);
  color: #2a2a2a;
}
.reveal-btn:hover {
  background: #d6b44d;
}

.reset-btn {
  background: var(--error);
}
.reset-btn:hover {
  background: #b85667;
}

/* ================= MC TOGGLE ================= */
.mc-toggle {
  text-align: left;
  max-width: 360px;
  margin: 10px auto 20px;
  padding-left: 12px;
  color: var(--text-secondary);
}

/* ================= QUESTION & PROGRESS ================= */
#progress {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 15px;
}

#question {
  font-size: 22px;
  margin: 10px 0 15px;
}

/* ================= MULTIPLE CHOICE ================= */
#answerArea button {
  background: var(--bg-elevated);
  border: 1px solid #2f2f2f;
  margin: 10px 0;
}

/* ================= FEEDBACK ================= */
.correct { color: var(--success); }
.accepted { color: var(--warning); }
.wrong { color: var(--error); }

#score {
  margin-top: 10px;
  color: var(--text-secondary);
}

.breakdown {
  margin-top: 15px;
  background: var(--bg-surface);
  padding: 15px;
  border-radius: 8px;
}
</style>
</head>

<body>

<h1>üåç Capital Quiz Pro</h1>

<label>Category</label>
<select id="category">
  <option value="world">World</option>
  <option value="africa">Africa</option>
  <option value="asia">Asia</option>
  <option value="europe">Europe</option>
  <option value="northamerica">North America</option>
  <option value="southamerica">South America</option>
  <option value="oceania">Oceania</option>
  <option value="middleeast">Middle East</option>
  <option value="india">India</option>
  <option value="canada">Canada</option>
</select>

<div class="mc-toggle">
  <label><input type="checkbox" id="mcMode"> Multiple Choice Mode</label>
</div>

<button class="start-btn" onclick="startQuiz()">START QUIZ</button>

<div id="progress"></div>
<div id="question"></div>
<div id="answerArea"></div>

<div class="actions">
  <button class="submit-btn" id="submitBtn" onclick="submitAnswer()" disabled>Submit</button>
  <button class="next-btn" id="nextBtn" onclick="nextQuestion()" disabled>Next</button>
  <button class="reveal-btn" onclick="revealAnswer()">Reveal Answer</button>
  <button class="reset-btn" onclick="resetQuiz()">Reset</button>
</div>

<div id="result"></div>
<div id="score">Score: 0 / 0</div>

<script>
const SESSION_LIMIT = 25;
let score = 0, total = 0, incorrect = 0;
let currentAnswer = [], questionPool = [], selectedMC = "";
const soundCorrect = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
const soundWrong = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");

const worldCapitals = {
"Afghanistan":["Kabul"],"Albania":["Tirana"],"Algeria":["Algiers"],"Andorra":["Andorra la Vella"],
"Angola":["Luanda"],"Antigua and Barbuda":["Saint John's"],"Argentina":["Buenos Aires"],
"Armenia":["Yerevan"],"Australia":["Canberra"],"Austria":["Vienna"],"Azerbaijan":["Baku"],
"Bahamas":["Nassau"],"Bahrain":["Manama"],"Bangladesh":["Dhaka"],"Barbados":["Bridgetown"],
"Belarus":["Minsk"],"Belgium":["Brussels"],"Belize":["Belmopan"],"Benin":["Porto-Novo"],
"Bhutan":["Thimphu"],"Bolivia":["La Paz","Sucre"],"Bosnia and Herzegovina":["Sarajevo"],
"Botswana":["Gaborone"],"Brazil":["Brasilia"],"Brunei":["Bandar Seri Begawan"],
"Bulgaria":["Sofia"],"Burkina Faso":["Ouagadougou"],"Burundi":["Gitega"],
"Cambodia":["Phnom Penh"],"Cameroon":["Yaounde"],"Canada":["Ottawa"],
"Central African Republic":["Bangui"],"Chad":["N'Djamena"],"Chile":["Santiago"],
"China":["Beijing"],"Colombia":["Bogota"],"Comoros":["Moroni"],
"Costa Rica":["San Jose"],"Croatia":["Zagreb"],"Cuba":["Havana"],
"Cyprus":["Nicosia"],"Czech Republic":["Prague"],"Denmark":["Copenhagen"],
"Djibouti":["Djibouti"],"Dominica":["Roseau"],"Dominican Republic":["Santo Domingo"],
"Ecuador":["Quito"],"Egypt":["Cairo"],"El Salvador":["San Salvador"],
"Equatorial Guinea":["Malabo"],"Eritrea":["Asmara"],"Estonia":["Tallinn"],
"Eswatini":["Mbabane","Lobamba"],"Ethiopia":["Addis Ababa"],"Fiji":["Suva"],
"Finland":["Helsinki"],"France":["Paris"],"Gabon":["Libreville"],
"Gambia":["Banjul"],"Georgia":["Tbilisi"],"Germany":["Berlin"],
"Ghana":["Accra"],"Greece":["Athens"],"Grenada":["St. George's"],
"Guatemala":["Guatemala City"],"Guinea":["Conakry"],"Guinea-Bissau":["Bissau"],
"Guyana":["Georgetown"],"Haiti":["Port-au-Prince"],"Honduras":["Tegucigalpa"],
"Hungary":["Budapest"],"Iceland":["Reykjavik"],"India":["New Delhi"],
"Indonesia":["Jakarta"],"Iran":["Tehran"],"Iraq":["Baghdad"],
"Ireland":["Dublin"],"Israel":["Jerusalem","Tel Aviv"],"Italy":["Rome"],
"Jamaica":["Kingston"],"Japan":["Tokyo"],"Jordan":["Amman"],
"Kazakhstan":["Astana"],"Kenya":["Nairobi"],"Kosovo":["Pristina"],
"Kuwait":["Kuwait City"],"Kyrgyzstan":["Bishkek"],"Laos":["Vientiane"],
"Latvia":["Riga"],"Lebanon":["Beirut"],"Lesotho":["Maseru"],
"Liberia":["Monrovia"],"Libya":["Tripoli"],"Liechtenstein":["Vaduz"],
"Lithuania":["Vilnius"],"Luxembourg":["Luxembourg"],
"Madagascar":["Antananarivo"],"Malawi":["Lilongwe"],
"Malaysia":["Kuala Lumpur"],"Maldives":["Male"],"Mali":["Bamako"],
"Malta":["Valletta"],"Mauritania":["Nouakchott"],"Mauritius":["Port Louis"],
"Mexico":["Mexico City"],"Moldova":["Chisinau"],"Monaco":["Monaco"],
"Mongolia":["Ulaanbaatar"],"Montenegro":["Podgorica"],
"Morocco":["Rabat"],"Mozambique":["Maputo"],"Myanmar":["Naypyidaw"],
"Namibia":["Windhoek"],"Nepal":["Kathmandu"],"Netherlands":["Amsterdam"],
"New Zealand":["Wellington"],"Nicaragua":["Managua"],"Niger":["Niamey"],
"Nigeria":["Abuja"],"North Korea":["Pyongyang"],
"North Macedonia":["Skopje"],"Norway":["Oslo"],"Oman":["Muscat"],
"Pakistan":["Islamabad"],"Palestine":["Ramallah"],
"Panama":["Panama City"],"Papua New Guinea":["Port Moresby"],
"Paraguay":["Asuncion"],"Peru":["Lima"],"Philippines":["Manila"],
"Poland":["Warsaw"],"Portugal":["Lisbon"],"Qatar":["Doha"],
"Romania":["Bucharest"],"Russia":["Moscow"],"Rwanda":["Kigali"],
"Saudi Arabia":["Riyadh"],"Senegal":["Dakar"],"Serbia":["Belgrade"],
"Seychelles":["Victoria"],"Sierra Leone":["Freetown"],
"Singapore":["Singapore"],"Slovakia":["Bratislava"],
"Slovenia":["Ljubljana"],"South Africa":["Pretoria","Cape Town","Bloemfontein"],
"South Sudan":["Juba"],"Spain":["Madrid"],
"Sri Lanka":["Sri Jayawardenepura Kotte","Colombo"],
"Sudan":["Khartoum"],"Suriname":["Paramaribo"],
"Sweden":["Stockholm"],"Switzerland":["Bern"],"Syria":["Damascus"],
"Taiwan":["Taipei"],"Tajikistan":["Dushanbe"],
"Tanzania":["Dodoma"],"Thailand":["Bangkok"],
"Togo":["Lome"],"Tunisia":["Tunis"],
"Turkey":["Ankara"],"Uganda":["Kampala"],
"Ukraine":["Kyiv"],
"United Arab Emirates":["Abu Dhabi"],
"United Kingdom":["London"],
"United States":["Washington D.C."],
"Uruguay":["Montevideo"],"Uzbekistan":["Tashkent"],
"Vatican City":["Vatican City"],
"Venezuela":["Caracas"],"Vietnam":["Hanoi"],
"Yemen":["Sana'a"],
"Zambia":["Lusaka"],"Zimbabwe":["Harare"]
};

/* ---------------- HELPERS ---------------- */
function normalize(str){return str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z\s]/g,"").trim();}
function similarity(a,b){
  const m=[];for(let i=0;i<=b.length;i++)m[i]=[i];for(let j=0;j<=a.length;j++)m[0][j]=j;
  for(let i=1;i<=b.length;i++)for(let j=1;j<=a.length;j++)
    m[i][j]=b[i-1]==a[j-1]?m[i-1][j-1]:Math.min(m[i-1][j-1]+1,m[i][j-1]+1,m[i-1][j]+1);
  return 1-m[b.length][a.length]/Math.max(a.length,b.length);
}

function getRandomChoices(correctAnswers){
  const allCapitals = Object.values(worldCapitals).flat();
  const correct = correctAnswers[Math.floor(Math.random()*correctAnswers.length)];
  const choices = new Set([correct]);
  while(choices.size<4){
    const rand = allCapitals[Math.floor(Math.random()*allCapitals.length)];
    if(!correctAnswers.includes(rand)) choices.add(rand);
  }
  return [...choices].sort(()=>Math.random()-0.5);
}

/* ---------------- GAME FLOW ---------------- */
function startQuiz(){
  score=total=incorrect=0;
  questionPool=Object.keys(worldCapitals).sort(()=>Math.random()-0.5);
  updateScore();
  nextQuestion();
}

function nextQuestion(){
  if(total>=SESSION_LIMIT){
    question.innerText="Session Complete üéâ";
    answerArea.innerHTML="";
    progress.innerText="";
    return;
  }
  submitBtn.disabled=true; nextBtn.disabled=true; selectedMC="";
  result.innerHTML="";
  const country = questionPool.pop();
  currentAnswer = worldCapitals[country];
  question.innerText=`Capital of ${country}?`;
  progress.innerText=`Question ${total+1} of ${SESSION_LIMIT}`;
  if(mcMode.checked){
    const choices = getRandomChoices(currentAnswer);
    answerArea.innerHTML=choices.map(c=>`<button onclick="selectMC('${c}')">${c}</button>`).join("");
  } else {
    answerArea.innerHTML=`<input id="textAnswer" placeholder="Type your answer‚Ä¶" oninput="submitBtn.disabled=false">`;
  }
}

function selectMC(val){selectedMC=val; submitBtn.disabled=false;}

function submitAnswer(){
  const input=selectedMC||document.getElementById("textAnswer")?.value;
  if(!input) return;
  total++;
  if(currentAnswer.some(a=>normalize(a)===normalize(input)||similarity(a,input)>0.8)){
    score++; result.innerHTML="<div class='correct'>‚úî Correct</div>";
  } else { incorrect++; result.innerHTML="<div class='wrong'>‚úñ "+currentAnswer.join(", ")+"</div>"; }
  updateScore();
  submitBtn.disabled=true; nextBtn.disabled=false; selectedMC="";
}

function revealAnswer(){result.innerHTML="<div class='accepted'>üí° "+currentAnswer.join(", ")+"</div>";}
function resetQuiz(){startQuiz();}
function updateScore(){document.getElementById("score").innerText=`Score: ${score} / ${total}`;}
</script>

</body>
</html>
