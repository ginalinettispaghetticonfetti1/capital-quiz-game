<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Capital Quiz Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= BASE ================= */
body {
  font-family: Arial, sans-serif;
  background: #121212;
  color: #ffffff;
  padding: 20px;
  text-align: center;
}

/* ================= FORM ELEMENTS ================= */
select, input {
  width: 100%;
  max-width: 360px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  border-radius: 6px;
  border: none;
  background: #1e1e1e;
  color: #ffffff;
}

/* ================= BUTTONS (BASE) ================= */
button {
  width: 100%;
  max-width: 360px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

/* ================= START QUIZ ================= */
.start-btn {
  background: #2e7d32;
  color: #ffffff;
  font-weight: bold;
}
.start-btn:hover {
  background: #1b5e20;
}

/* ================= MC MODE TOGGLE ================= */
.mc-toggle {
  text-align: left;
  max-width: 360px;
  margin: 10px auto 20px;
  padding-left: 12px;
}

/* ================= QUESTION ================= */
#question {
  font-size: 22px;
  margin: 20px 0;
}

/* ================= MULTIPLE CHOICE OPTIONS ================= */
#answerArea button {
  background: #263238;
  color: #e0f7fa;
  border: 1px solid #37474f;
  margin: 10px 0;
}
#answerArea button:hover {
  background: #37474f;
}

/* ================= ACTION BUTTONS ================= */
.actions {
  margin-top: 30px;
}

.submit-btn {
  background: #1976d2;
}
.submit-btn:hover {
  background: #0d47a1;
}

.next-btn {
  background: #7b1fa2;
}
.next-btn:hover {
  background: #4a148c;
}

.reveal-btn {
  background: #f9a825;
  color: #000000;
}
.reveal-btn:hover {
  background: #f57f17;
}

.reset-btn {
  background: #c62828;
}
.reset-btn:hover {
  background: #8e0000;
}

/* ================= FEEDBACK ================= */
.correct { color: #4caf50; }
.accepted { color: #ffeb3b; }
.wrong { color: #f44336; }

#score {
  margin-top: 10px;
  font-size: 18px;
}

.breakdown {
  margin-top: 15px;
  background: #1e1e1e;
  padding: 15px;
  border-radius: 8px;
}
</style>
</head>

<body>

<h1>üåç Capital Quiz Pro</h1>

<label>Category</label>
<select id="category">
  <option value="world">World</option>
  <option value="africa">Africa</option>
  <option value="asia">Asia</option>
  <option value="europe">Europe</option>
  <option value="northamerica">North America</option>
  <option value="southamerica">South America</option>
  <option value="oceania">Oceania</option>
  <option value="middleeast">Middle East</option>
  <option value="india">India</option>
  <option value="canada">Canada</option>
</select>

<label>Difficulty</label>
<select id="difficulty">
  <option value="easy">Easy</option>
  <option value="medium">Medium</option>
  <option value="hard">Hard</option>
</select>

<div class="mc-toggle">
  <label>
    <input type="checkbox" id="mcMode"> Multiple Choice Mode
  </label>
</div>

<button class="start-btn" onclick="startQuiz()">START QUIZ</button>

<div id="question"></div>
<div id="answerArea"></div>

<div class="actions">
  <button class="submit-btn" onclick="submitAnswer()">Submit</button>
  <button class="next-btn" onclick="nextQuestion()">Next</button>
  <button class="reveal-btn" onclick="revealAnswer()">Reveal Answer</button>
  <button class="reset-btn" onclick="resetQuiz()">Reset</button>
</div>

<div id="result"></div>
<div id="score">Score: 0 / 0</div>

<script>
/* ---------------- CONFIG ---------------- */
const SESSION_LIMIT = 25;

/* ---------------- SOUNDS ---------------- */
const soundCorrect = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
const soundWrong = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");

/* ---------------- STATE ---------------- */
let score = 0;
let total = 0;
let incorrect = 0;
let currentAnswer = [];
let questionPool = [];

/* ---------------- WORLD DATA ---------------- */
const worldCapitals = {
"Afghanistan":["Kabul"],"Albania":["Tirana"],"Algeria":["Algiers"],"Andorra":["Andorra la Vella"],
"Angola":["Luanda"],"Antigua and Barbuda":["Saint John's"],"Argentina":["Buenos Aires"],
"Armenia":["Yerevan"],"Australia":["Canberra"],"Austria":["Vienna"],"Azerbaijan":["Baku"],
"Bahamas":["Nassau"],"Bahrain":["Manama"],"Bangladesh":["Dhaka"],"Barbados":["Bridgetown"],
"Belarus":["Minsk"],"Belgium":["Brussels"],"Belize":["Belmopan"],"Benin":["Porto-Novo"],
"Bhutan":["Thimphu"],"Bolivia":["La Paz","Sucre"],"Bosnia and Herzegovina":["Sarajevo"],
"Botswana":["Gaborone"],"Brazil":["Brasilia"],"Brunei":["Bandar Seri Begawan"],
"Bulgaria":["Sofia"],"Burkina Faso":["Ouagadougou"],"Burundi":["Gitega"],
"Cambodia":["Phnom Penh"],"Cameroon":["Yaounde"],"Canada":["Ottawa"],
"Central African Republic":["Bangui"],"Chad":["N'Djamena"],"Chile":["Santiago"],
"China":["Beijing"],"Colombia":["Bogota"],"Comoros":["Moroni"],
"Costa Rica":["San Jose"],"Croatia":["Zagreb"],"Cuba":["Havana"],
"Cyprus":["Nicosia"],"Czech Republic":["Prague"],"Denmark":["Copenhagen"],
"Djibouti":["Djibouti"],"Dominica":["Roseau"],"Dominican Republic":["Santo Domingo"],
"Ecuador":["Quito"],"Egypt":["Cairo"],"El Salvador":["San Salvador"],
"Equatorial Guinea":["Malabo"],"Eritrea":["Asmara"],"Estonia":["Tallinn"],
"Eswatini":["Mbabane","Lobamba"],"Ethiopia":["Addis Ababa"],"Fiji":["Suva"],
"Finland":["Helsinki"],"France":["Paris"],"Gabon":["Libreville"],
"Gambia":["Banjul"],"Georgia":["Tbilisi"],"Germany":["Berlin"],
"Ghana":["Accra"],"Greece":["Athens"],"Grenada":["St. George's"],
"Guatemala":["Guatemala City"],"Guinea":["Conakry"],"Guinea-Bissau":["Bissau"],
"Guyana":["Georgetown"],"Haiti":["Port-au-Prince"],"Honduras":["Tegucigalpa"],
"Hungary":["Budapest"],"Iceland":["Reykjavik"],"India":["New Delhi"],
"Indonesia":["Jakarta"],"Iran":["Tehran"],"Iraq":["Baghdad"],
"Ireland":["Dublin"],"Israel":["Jerusalem","Tel Aviv"],"Italy":["Rome"],
"Jamaica":["Kingston"],"Japan":["Tokyo"],"Jordan":["Amman"],
"Kazakhstan":["Astana"],"Kenya":["Nairobi"],"Kosovo":["Pristina"],
"Kuwait":["Kuwait City"],"Kyrgyzstan":["Bishkek"],"Laos":["Vientiane"],
"Latvia":["Riga"],"Lebanon":["Beirut"],"Lesotho":["Maseru"],
"Liberia":["Monrovia"],"Libya":["Tripoli"],"Liechtenstein":["Vaduz"],
"Lithuania":["Vilnius"],"Luxembourg":["Luxembourg"],"Madagascar":["Antananarivo"],
"Malawi":["Lilongwe"],"Malaysia":["Kuala Lumpur"],"Maldives":["Male"],
"Mali":["Bamako"],"Malta":["Valletta"],"Mauritania":["Nouakchott"],
"Mauritius":["Port Louis"],"Mexico":["Mexico City"],"Moldova":["Chisinau"],
"Monaco":["Monaco"],"Mongolia":["Ulaanbaatar"],"Montenegro":["Podgorica"],
"Morocco":["Rabat"],"Mozambique":["Maputo"],"Myanmar":["Naypyidaw"],
"Namibia":["Windhoek"],"Nepal":["Kathmandu"],"Netherlands":["Amsterdam"],
"New Zealand":["Wellington"],"Nicaragua":["Managua"],"Niger":["Niamey"],
"Nigeria":["Abuja"],"North Korea":["Pyongyang"],"North Macedonia":["Skopje"],
"Norway":["Oslo"],"Oman":["Muscat"],"Pakistan":["Islamabad"],
"Palestine":["Ramallah"],"Panama":["Panama City"],"Papua New Guinea":["Port Moresby"],
"Paraguay":["Asuncion"],"Peru":["Lima"],"Philippines":["Manila"],
"Poland":["Warsaw"],"Portugal":["Lisbon"],"Qatar":["Doha"],
"Romania":["Bucharest"],"Russia":["Moscow"],"Rwanda":["Kigali"],
"Saudi Arabia":["Riyadh"],"Senegal":["Dakar"],"Serbia":["Belgrade"],
"Seychelles":["Victoria"],"Sierra Leone":["Freetown"],"Singapore":["Singapore"],
"Slovakia":["Bratislava"],"Slovenia":["Ljubljana"],
"South Africa":["Pretoria","Cape Town","Bloemfontein"],
"South Sudan":["Juba"],"Spain":["Madrid"],"Sri Lanka":["Sri Jayawardenepura Kotte","Colombo"],
"Sudan":["Khartoum"],"Suriname":["Paramaribo"],"Sweden":["Stockholm"],
"Switzerland":["Bern"],"Syria":["Damascus"],"Taiwan":["Taipei"],
"Tajikistan":["Dushanbe"],"Tanzania":["Dodoma"],"Thailand":["Bangkok"],
"Togo":["Lome"],"Tunisia":["Tunis"],"Turkey":["Ankara"],
"Uganda":["Kampala"],"Ukraine":["Kyiv"],
"United Arab Emirates":["Abu Dhabi"],"United Kingdom":["London"],
"United States":["Washington D.C."],"Uruguay":["Montevideo"],
"Uzbekistan":["Tashkent"],"Vatican City":["Vatican City"],
"Venezuela":["Caracas"],"Vietnam":["Hanoi"],"Yemen":["Sana'a"],
"Zambia":["Lusaka"],"Zimbabwe":["Harare"]
};

/* ---------------- HELPERS ---------------- */
function normalize(str){
  return str.toLowerCase().normalize("NFD")
    .replace(/[\u0300-\u036f]/g,"")
    .replace(/[^a-z\s]/g,"").trim();
}

function levenshtein(a,b){
  const m=[];
  for(let i=0;i<=b.length;i++)m[i]=[i];
  for(let j=0;j<=a.length;j++)m[0][j]=j;
  for(let i=1;i<=b.length;i++)
    for(let j=1;j<=a.length;j++)
      m[i][j]=b[i-1]==a[j-1]?m[i-1][j-1]:
        Math.min(m[i-1][j-1]+1,m[i][j-1]+1,m[i-1][j]+1);
  return m[b.length][a.length];
}

function similarity(a,b){
  return 1-levenshtein(a,b)/Math.max(a.length,b.length);
}

/* ---------- MULTIPLE CHOICE ---------- */
function getRandomChoices(correctAnswers){
  const allCapitals = Object.values(worldCapitals).flat();
  const correct = correctAnswers[Math.floor(Math.random()*correctAnswers.length)];
  const choices = new Set([correct]);

  while(choices.size < 4){
    const rand = allCapitals[Math.floor(Math.random()*allCapitals.length)];
    if(!correctAnswers.includes(rand)) choices.add(rand);
  }
  return [...choices].sort(()=>Math.random()-0.5);
}

/* ---------------- GAME FLOW ---------------- */
function startQuiz(){
  score=total=incorrect=0;
  scoreDisplay();
  questionPool=Object.keys(worldCapitals).sort(()=>Math.random()-0.5);
  nextQuestion();
}

function nextQuestion(){
  if(total>=SESSION_LIMIT){
    const accuracy=Math.round((score/SESSION_LIMIT)*100);
    result.innerHTML=`
      <div class="breakdown">
        üéâ <b>Session Complete!</b><br><br>
        Score: ${score} / ${SESSION_LIMIT}<br>
        Correct: ${score}<br>
        Incorrect: ${incorrect}<br>
        Accuracy: ${accuracy}%
      </div>`;
    question.innerText="Done!";
    answerArea.innerHTML="";
    return;
  }

  const country=questionPool.pop();
  currentAnswer=worldCapitals[country];
  question.innerText="Capital of "+country+"?";
  result.innerHTML="";

  if(document.getElementById("mcMode").checked){
    const choices = getRandomChoices(currentAnswer);
    answerArea.innerHTML = choices
      .map(c=>`<button onclick="submitAnswer('${c}')">${c}</button>`)
      .join("");
  } else {
    answerArea.innerHTML = `<input id="textAnswer" placeholder="Type answer">`;
  }
}

function submitAnswer(ans){
  const input = ans || document.getElementById("textAnswer")?.value;
  if(!input) return;

  total++;
  let ok=false;

  currentAnswer.forEach(a=>{
    const u=normalize(input),c=normalize(a);
    if(u===c || similarity(u,c)>0.8) ok=true;
  });

  if(ok){
    score++;
    soundCorrect.play();
    result.innerHTML="<div class='correct'>‚úÖ Correct</div>";
  } else {
    incorrect++;
    soundWrong.play();
    result.innerHTML="<div class='wrong'>‚ùå "+currentAnswer.join(", ")+"</div>";
  }

  scoreDisplay();
}

function revealAnswer(){
  result.innerHTML="<div class='accepted'>üí° "+currentAnswer.join(", ")+"</div>";
}

function resetQuiz(){ startQuiz(); }

function scoreDisplay(){
  document.getElementById("score").innerText=`Score: ${score} / ${total}`;
}
</script>

</body>
</html>
